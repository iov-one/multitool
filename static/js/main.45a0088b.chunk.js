(window.webpackJsonpmultitool=window.webpackJsonpmultitool||[]).push([[0],{120:function(e,t){},183:function(e,t,n){e.exports=n(397)},185:function(e,t,n){},198:function(e,t){},204:function(e,t){},206:function(e,t){},255:function(e,t){},397:function(e,t,n){"use strict";n.r(t);n(184),n(185);var r=n(0),a=n.n(r),i=n(70),o=n.n(i),s=n(15),c=n(71),l=n(179),u=n(24),m=n(20),h=n(32),f=n(31),d=n(33),p=n(10),g=n(17),b=n(1),E=n(34),v=n.n(E),y=n(11),w=n.n(y),k=n(40),S=n.n(k),O=n(26),x=n.n(O),I=function(e){var t=e.error;return a.a.createElement(v.a,{variant:"danger",hidden:!t},t)},j=new Map([["local-iov-devnet",{id:"local-iov-devnet",tokenTicker:"CASH",fee:{quantity:"100000000",fractionalDigits:9,tokenTicker:"CASH"},nodeUrl:"ws://localhost:23456/",networkType:"testnet",recipientPrefix:"tiov"}],["iov-boarnet",{id:"iov-boarnet",tokenTicker:"IOV",fee:{quantity:"100000000",fractionalDigits:9,tokenTicker:"IOV"},nodeUrl:"wss://rpc.boarnet.iov.one",networkType:"testnet",recipientPrefix:"tiov"}],["iov-mainnet",{id:"iov-mainnet",tokenTicker:"IOV",fee:{quantity:"100000000",fractionalDigits:9,tokenTicker:"IOV"},nodeUrl:"wss://rpc.mainnet.iov.one",networkType:"mainnet",recipientPrefix:"iov"}]]),q=n(7),N=n.n(q),C=function(){function e(t,n){Object(u.a)(this,e),this.data=void 0,this.data={atomics:new N.a(t),fractionalDigits:n}}return Object(m.a)(e,[{key:"atomics",get:function(){return this.data.atomics.toString()}}],[{key:"fromUserInput",value:function(t,n){if(!Number.isInteger(n))throw new Error("Fractional digits is not an integer");if(n<0)throw new Error("Fractional digits must not be negative");for(var r=0;r<t.length;r++)if(!t[r].match(/^[0-9.]$/))throw new Error("Invalid character at position ".concat(r+1));var a,i;if(-1===t.search(/\./))a=t,i="";else{var o=t.split(".");switch(o.length){case 0:case 1:throw new Error("Less than two elements in split result. This must not happen here.");case 2:if(!o[1])throw new Error("Fractional part missing");a=o[0],i=o[1].replace(/0+$/,"");break;default:throw new Error("More than one separator found")}}if(i.length>n)throw new Error("Got more fractional digits than supported");return new e("".concat(a).concat(i.padEnd(n,"0")),n)}},{key:"fromAtomics",value:function(t,n){if(!Number.isInteger(n))throw new Error("Fractional digits is not an integer");if(n<0)throw new Error("Fractional digits must not be negative");return new e(t,n)}}]),Object(m.a)(e,[{key:"toString",value:function(){var e=new N.a(10).pow(new N.a(this.data.fractionalDigits)),t=this.data.atomics.div(e),n=this.data.atomics.mod(e);if(n.isZero())return t.toString();var r=n.toString().padStart(this.data.fractionalDigits,"0").replace(/0+$/,"");return"".concat(t.toString(),".").concat(r)}}]),e}();function T(e){var t=e.quantity,n=e.fractionalDigits,r=e.tokenTicker;return"".concat(C.fromAtomics(t,n).toString()," ").concat(r)}var A=n(2),M=n.n(A),P=n(27);function F(e){return J.apply(this,arguments)}function J(){return(J=Object(P.a)(M.a.mark((function e(t){var n,r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=j.get(t)){e.next=3;break}throw new Error("Chain not found");case 3:return r=Object(g.createBnsConnector)(n.nodeUrl,t),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return U.apply(this,arguments)}function U(){return(U=Object(P.a)(M.a.mark((function e(t){var n,r,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t.chainId);case 2:return n=e.sent,e.next=5,n.establishConnection();case 5:return r=e.sent,e.next=8,r.getNonce({pubkey:t.pubkey});case 8:return a=e.sent,r.disconnect(),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(P.a)(M.a.mark((function e(t,n){var r,a,i,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(g.multisignatureIdToAddress)(t,Uint8Array.from(b.Uint64.fromNumber(n).toBytesBigEndian())),e.next=3,F(t);case 3:return a=e.sent,e.next=6,a.establishConnection();case 6:return i=e.sent,e.next=9,i.getAccount({address:r});case 9:return o=e.sent,i.disconnect(),e.abrupt("return",{address:r,balance:o?o.balance:void 0});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return(B=Object(P.a)(M.a.mark((function e(t){var n,r,a,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t.transaction.creator.chainId);case 2:return n=e.sent,e.next=5,n.establishConnection();case 5:return r=e.sent,e.next=8,r.postTx(g.bnsCodec.bytesToPost(t));case 8:return a=e.sent,e.next=11,a.blockInfo.waitFor((function(e){return!Object(p.isBlockInfoPending)(e)}));case 11:if(i=e.sent,!Object(p.isBlockInfoPending)(i)){e.next=14;break}throw new Error("Block info still pending. This is a bug");case 14:if(!Object(p.isBlockInfoFailed)(i)){e.next=16;break}throw new Error("Error posting transaction: ".concat(i.message));case 16:return e.abrupt("return",a.transactionId);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){var t="string"===typeof e?JSON.parse(e):e;return JSON.stringify(t,null,2)}var R=n(45),V=n(95),Q=n.n(V),_=0;function z(e){return W.apply(this,arguments)}function W(){return(W=Object(P.a)(M.a.mark((function e(t){var n,r,a,i,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.a.create(1e3);case 2:return n=e.sent,e.prev=3,r=new R.IovLedgerApp(n),e.next=7,r.getVersion();case 7:if(a=e.sent,Object(R.isIovLedgerAppVersion)(a)){e.next=10;break}throw new Error(a.errorMessage);case 10:if(i=a.testMode?"testnet":"mainnet",t===i){e.next=13;break}throw new Error("Pubkey for ".concat(t," required but got response from the ").concat(i," app"));case 13:return e.next=15,r.getAddress(_);case 15:if(o=e.sent,Object(R.isIovLedgerAppAddress)(o)){e.next=18;break}throw new Error(o.errorMessage);case 18:return e.abrupt("return",{pubkey:o.pubkey});case 19:return e.prev=19,e.next=22,n.close();case 22:return e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[3,,19,23]])})))).apply(this,arguments)}function Z(e,t){return $.apply(this,arguments)}function $(){return($=Object(P.a)(M.a.mark((function e(t,n){var r,a,i,o,s,c,l,u,m;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(n);case 2:return r=e.sent,a=g.bnsCodec.bytesToSign(t,r),i=a.bytes,o="iov-mainnet"===n.chainId?"mainnet":"testnet",e.next=7,Q.a.create(5e3);case 7:return s=e.sent,e.prev=8,c=new R.IovLedgerApp(s),e.next=12,c.getVersion();case 12:if(l=e.sent,Object(R.isIovLedgerAppVersion)(l)){e.next=15;break}throw new Error(l.errorMessage);case 15:if(u=l.testMode?"testnet":"mainnet",o===u){e.next=18;break}throw new Error("Pubkey for ".concat(o," required but got response from the ").concat(u," app"));case 18:return e.next=20,c.sign(_,i);case 20:if(m=e.sent,Object(R.isIovLedgerAppSignature)(m)){e.next=23;break}throw new Error(m.errorMessage);case 23:return e.abrupt("return",{pubkey:n.pubkey,nonce:r,signature:m.signature});case 24:return e.prev=24,e.next=27,s.close();case 27:return e.finish(24);case 28:case"end":return e.stop()}}),e,null,[[8,,24,28]])})))).apply(this,arguments)}function G(){return(G=Object(P.a)(M.a.mark((function e(t){var n,r,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.TransactionEncoder.fromJson(JSON.parse(t)),Object(p.isUnsignedTransaction)(n)&&Object(p.isSendTransaction)(n)&&Object(g.isMultisignatureTx)(n)){e.next=3;break}throw new Error("Invalid transaction format in RPC request to Ledger endpoint.");case 3:return e.next=5,Z(n,n.creator);case 5:return r=e.sent,a={transaction:n,primarySignature:r,otherSignatures:[]},e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){if(!Object(b.isNonNullObject)(e))return!1;var t=e,n=t.nonce,r=t.pubkey,a=t.signature;return"number"===typeof n&&(!!Object(p.isPubkeyBundle)(r)&&!!Object(b.isUint8Array)(a))}function K(e){return JSON.stringify(b.TransactionEncoder.toJson(e))}var X=b.Encoding.fromUtf8,ee=b.Encoding.toUtf8;function te(e){var t;return function(e){return b.Encoding.toBase64(e).replace("+","-").replace("/","_")}(ee((t=e,JSON.stringify(b.TransactionEncoder.toJson(t)))))}function ne(e){var t=function(e){return b.Encoding.fromBase64(e.replace("-","+").replace("_","/"))}(e),n=b.TransactionEncoder.fromJson(JSON.parse(X(t)));if(!function(e){if(!Object(b.isNonNullObject)(e))return!1;var t=e,n=t.transaction,r=t.primarySignature,a=t.otherSignatures;return!!Object(p.isUnsignedTransaction)(n)&&(!!Object(p.isSendTransaction)(n)&&(!!Object(g.isMultisignatureTx)(n)&&(!!Y(r)&&!(!Array.isArray(a)||a.some((function(e){return!Y(e)}))))))}(n))throw new Error("Transaction data is not an SignedTransaction<SendTransaction & MultisignatureTx & WithCreator>");return n}function re(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=te(e),r=t?window.location.href.split("#")[0]+"#":"";return"".concat(r,"/sign/").concat(n)}function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ie={creatorHex:"",chainId:"iov-boarnet",formMultisigContractId:"21",formRecipient:"tiov1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqplsnxjl",formQuantity:"100.56",formMemo:"What a wonderful day",unsignedTransactionJson:null,encodingError:null,signing:!1},oe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},ie),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(){var e=this,t=null;try{var n=j.get(this.state.chainId);if(!n)throw new Error("No configuration for theis chain ID found");this.state.lastQueriedMultisigContractId!==this.state.formMultisigContractId&&(this.setState({lastQueriedMultisigContractId:this.state.formMultisigContractId,contractInfo:void 0}),function(e,t){return L.apply(this,arguments)}(n.id,b.Uint64.fromString(this.state.formMultisigContractId).toNumber()).then((function(t){var n=t.address,r=t.balance;e.setState({contractInfo:{address:n,balance:r}})})).catch((function(e){return console.error(e)})));var r=b.Uint64.fromString(this.state.formMultisigContractId),a=Object(g.multisignatureIdToAddress)(this.state.chainId,Uint8Array.from(r.toBytesBigEndian()));if(!this.state.creatorHex)throw new Error("Transaction creator unset");if(!this.state.formRecipient.startsWith(n.recipientPrefix))throw new Error("Recipient address with prefix '".concat(n.recipientPrefix,"' expected"));var i={kind:"bcp/send",creator:{chainId:this.state.chainId,pubkey:{algo:p.Algorithm.Ed25519,data:b.Encoding.fromHex(this.state.creatorHex)}},amount:{quantity:C.fromUserInput(this.state.formQuantity,9).atomics,fractionalDigits:9,tokenTicker:n.tokenTicker},sender:a,recipient:this.state.formRecipient,memo:this.state.formMemo,fee:{tokens:n.fee},multisig:[r.toNumber()]};g.bnsCodec.bytesToSign(i,0);var o=JSON.stringify(b.TransactionEncoder.toJson(i));this.state.unsignedTransactionJson!==o&&this.setState({unsignedTransactionJson:o,encodingError:null})}catch(s){t=s instanceof Error?s.message:s.toString()}this.state.encodingError!==t&&this.setState({unsignedTransactionJson:null,encodingError:t})}},{key:"render",value:function(){var e=this;return a.a.createElement(S.a,null,this.state.statusUrl&&a.a.createElement(s.a,{to:this.state.statusUrl,push:!0}),a.a.createElement(x.a,null,a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h3",null,"Enter transaction"),a.a.createElement("form",null,a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"chainIdInput"},"Chain ID"),a.a.createElement("select",{className:"form-control",id:"chainIdInput",value:this.state.chainId,onChange:function(t){return e.handleFormChange("chainId",t)}},Array.from(j.keys()).map((function(e){return a.a.createElement("option",null,e)})))),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"creatorInput"},"Transaction creator"),a.a.createElement("button",{className:"btn btn-link btn-sm",onClick:function(t){t.preventDefault(),e.reloadCreatorFromLedger()}},"Get from Ledger"),a.a.createElement("button",{className:"btn btn-link btn-sm",onClick:function(t){t.preventDefault(),e.clearCreator()}},"Clear"),a.a.createElement("input",{id:"creatorInput",className:"form-control",type:"text",placeholder:"Creator pubkey ",value:this.state.creatorHex,disabled:!0}),a.a.createElement("small",{className:"form-text text-muted"},"Pubkey of the person who creates this transaction")),a.a.createElement(I,{error:this.state.getPubkeyError}),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"senderInput"},"Multisig contract ID"),a.a.createElement("input",{id:"senderInput",className:"form-control",type:"text",placeholder:"Sender",value:this.state.formMultisigContractId,onChange:function(t){return e.handleFormChange("multisigContractId",t)}}),a.a.createElement("small",{className:"form-text text-muted"},"Use integer format, e.g. 42"),a.a.createElement("div",{className:"invalid-feedback"},"Please choose a username.")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"recipientInput"},"Recipient address"),a.a.createElement("input",{id:"recipientInput",className:"form-control",type:"text",placeholder:"Recipient",value:this.state.formRecipient,onChange:function(t){return e.handleFormChange("recipient",t)}}),a.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"IOV address, e.g. iov1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqp396zjw")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"quantityInput"},"Quantity"),a.a.createElement("input",{id:"quantityInput",className:"form-control",type:"text",placeholder:"100.56",value:this.state.formQuantity,onChange:function(t){return e.handleFormChange("quantity",t)}}),a.a.createElement("small",{className:"form-text text-muted"},"Quantity, e.g. 100.56 for 100.56 IOV")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"memoInput"},"Memo"),a.a.createElement("input",{id:"memoInput",className:"form-control",type:"text",placeholder:"Memo",value:this.state.formMemo,onChange:function(t){return e.handleFormChange("memo",t)}}),a.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"Arbitrary text attached to the transaction")),a.a.createElement("p",null,a.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:this.state.signing||!this.state.unsignedTransactionJson,onClick:function(t){t.preventDefault(),e.signAndContinue()}},"Sign and continue")),a.a.createElement(v.a,{hidden:!this.state.signing,variant:"info"},"Please sign transaction using Ledger device now"),a.a.createElement(I,{error:this.state.signingError}))),a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h3",null,"Multisig contract info"),this.state.contractInfo&&a.a.createElement("p",null,"Address: ",this.state.contractInfo.address,a.a.createElement("br",null),"Balance:"," ",this.state.contractInfo.balance?this.state.contractInfo.balance.map(T).join(", "):"\u2013"),a.a.createElement("h3",null,"Details"),this.state.unsignedTransactionJson&&a.a.createElement("div",null,a.a.createElement("p",null,"This is a machine processable representation of the transaction."),a.a.createElement("pre",null,H(this.state.unsignedTransactionJson))),a.a.createElement(v.a,{variant:"danger",hidden:!this.state.encodingError},a.a.createElement("p",{className:"mb-0"},a.a.createElement("strong",null,"Transaction encoding error:"),a.a.createElement("br",null),this.state.encodingError)))))}},{key:"handleFormChange",value:function(e,t){var n=t.target.value;switch(e){case"chainId":this.setState({chainId:n});break;case"multisigContractId":this.setState({formMultisigContractId:n});break;case"recipient":this.setState({formRecipient:n});break;case"quantity":this.setState({formQuantity:n});break;case"memo":this.setState({formMemo:n});break;default:throw new Error("Unsupported form field '".concat(e,"'"))}}},{key:"clearCreator",value:function(){this.setState({creatorHex:"",getPubkeyError:void 0})}},{key:"reloadCreatorFromLedger",value:function(){var e=this;this.clearCreator();var t=j.get(this.state.chainId);if(!t)throw new Error("Chain not found");z(t.networkType).then((function(t){var n=b.Encoding.toHex(t.pubkey);console.log("Received pubkey from Ledger:",n),e.setState({creatorHex:n})}),(function(t){console.info("Full error message",t);var n=t instanceof Error?t.message:t.toString();e.setState({getPubkeyError:n})}))}},{key:"signAndContinue",value:function(){var e=this;if(this.setState({signingError:void 0,signing:!0}),!this.state.unsignedTransactionJson)throw new Error("unsigned transaction not set");(function(e){return G.apply(this,arguments)})(this.state.unsignedTransactionJson).then((function(t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=te(e),r=t?window.location.href.split("#")[0]+"#":"";return"".concat(r,"/status/").concat(n)}(t);console.log("Navigating to",n),e.setState({statusUrl:n,signing:!1})}),(function(t){console.info("Full error message",t);var n=t instanceof Error?t.message:t.toString();e.setState({signingError:n,signing:!1})}))}}]),t}(a.a.Component),se=n(56),ce=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={transaction:null,signatures:[],localSignature:"",signing:!1},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){if(!this.state.transaction){var e=window.location.href.match(/\/sign\/([-_=a-zA-Z0-9]+)/);if(e&&e.length>=2){var t=ne(e[1]),n=t.transaction,r=t.primarySignature,a=t.otherSignatures;this.setState({transaction:n,signatures:[r].concat(Object(se.a)(a))})}}}},{key:"render",value:function(){var e=this;return a.a.createElement(S.a,null,a.a.createElement(x.a,null,a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h2",null,"Review transaction"),a.a.createElement("pre",null,H(b.TransactionEncoder.toJson(this.state.transaction)))),a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h2",null,"Create Signature"),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"yourSignature"},"Your signature"),a.a.createElement("textarea",{className:"form-control",id:"yourSignature",rows:6,value:this.state.localSignature,readOnly:!0})),a.a.createElement("p",null,a.a.createElement("button",{className:"btn btn-primary",onClick:function(){var t=Object(P.a)(M.a.mark((function t(n){var r,a;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),e.setState({localSignature:"",signingError:void 0,signing:!0}),t.prev=2,t.next=5,e.createSignature();case 5:r=t.sent,e.setState({localSignature:r,signing:!1}),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(2),console.info("Full error message",t.t0),a=t.t0 instanceof Error?t.t0.message:t.t0.toString(),e.setState({signingError:a,signing:!1});case 14:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()},"Sign transaction now")),a.a.createElement(v.a,{hidden:!this.state.signing,variant:"info"},"Please sign transaction using Ledger device now"),a.a.createElement(I,{error:this.state.signingError}))),a.a.createElement(x.a,null,a.a.createElement(w.a,null,"\xa0")))}},{key:"createSignature",value:function(){var e=Object(P.a)(M.a.mark((function e(){var t,n,r,a,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.transaction){e.next=3;break}throw new Error("Transaction not set");case 3:if(n=j.get(t.creator.chainId)){e.next=6;break}throw new Error("Chain not found");case 6:return e.next=8,z(n.networkType);case 8:return r=e.sent,a={chainId:t.creator.chainId,pubkey:{algo:p.Algorithm.Ed25519,data:r.pubkey}},e.next=12,Z(t,a);case 12:return i=e.sent,e.abrupt("return",K(i));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(a.a.Component),le=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return a.a.createElement(S.a,null,a.a.createElement(x.a,null,a.a.createElement(w.a,null,a.a.createElement("h1",null,"Multitool"),a.a.createElement("h2",null,"Create multisignatures transactions using Ledger Nano S"))),a.a.createElement(x.a,null,a.a.createElement(w.a,{className:""}),a.a.createElement(w.a,{className:"col-4"},a.a.createElement(c.b,{to:"/create",className:"btn btn-lg btn-block btn-primary"},"Create new transaction")),a.a.createElement(w.a,{className:""}),a.a.createElement(w.a,{className:"col-4"},"\xa0"),a.a.createElement(w.a,{className:""})))}}]),t}(a.a.Component),ue=b.Encoding.toHex,me=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("ol",{className:"list-group mb-3"},this.props.signatures.map((function(t){return a.a.createElement("li",{className:"list-group-item",key:ue(t.pubkey.data)},g.bnsCodec.identityToAddress({chainId:e.props.chainId,pubkey:t.pubkey}),": ",a.a.createElement("code",null,K(t)))})))}}]),t}(a.a.Component),he=b.Encoding.toHex,fe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={original:null,signatures:[],localSignature:"",posting:!1},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){if(!this.state.original){var e=window.location.href.match(/\/status\/([-_=a-zA-Z0-9]+)/);if(e&&e.length>=2){var t=ne(e[1]),n=t.primarySignature,r=t.otherSignatures;this.setState({original:t,signatures:[n].concat(Object(se.a)(r))})}}}},{key:"render",value:function(){var e=this;return a.a.createElement(S.a,null,a.a.createElement(x.a,null,a.a.createElement(w.a,null,a.a.createElement("h2",null,"Signing link"),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"signingLink"},"Send this link to every user supposed to sign this transaction"),a.a.createElement("textarea",{className:"form-control",id:"signingLink",rows:3,value:this.state.original?re(this.state.original,!0):"",readOnly:!0})))),a.a.createElement(x.a,null,a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h2",null,"Review transaction"),a.a.createElement("pre",null,this.state.original?H(b.TransactionEncoder.toJson(this.state.original.transaction)):"")),a.a.createElement(w.a,{className:"col-6"},a.a.createElement("h2",null,"Signatures (",this.state.signatures.length,")"),this.state.original&&a.a.createElement(me,{chainId:this.state.original.transaction.creator.chainId,signatures:this.state.signatures}),a.a.createElement("p",null,a.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(t){t.preventDefault(),e.setState({addSignatureError:void 0});var n=prompt("Please enter signature");if(null!==n)try{console.log(n);var r=function(e){var t=b.TransactionEncoder.fromJson(JSON.parse(e));if(!Y(t))throw new Error("Invalid signature format");return t}(n);if(e.state.signatures.map((function(e){return he(e.pubkey.data)})).find((function(e){return e===he(r.pubkey.data)})))throw new Error("Signature of this account already included");e.setState({signatures:[].concat(Object(se.a)(e.state.signatures),[r])})}catch(i){console.info("Full error message",i);var a=i instanceof Error?i.message:i.toString();e.setState({addSignatureError:a})}}},"Add signature")),a.a.createElement(I,{error:this.state.addSignatureError}),a.a.createElement("h2",null,"Post to blockchain"),a.a.createElement("div",{hidden:!!this.state.postSuccess},a.a.createElement("p",null,"The transaction with all signatures from above will be posted to the IOV blockchain."),a.a.createElement("p",null,a.a.createElement("button",{className:"btn btn-primary",disabled:this.state.posting,onClick:function(t){t.preventDefault(),e.postToChain()}},"Post now"))),a.a.createElement(v.a,{variant:"success",hidden:!this.state.postSuccess},a.a.createElement("p",null,"Sucessfully posted transaction with ID ",this.state.postSuccess," to the blockchain.")),a.a.createElement(I,{error:this.state.postError}))),a.a.createElement(x.a,null,a.a.createElement(w.a,null,"\xa0")))}},{key:"postToChain",value:function(){var e=this;if(!this.state.original)throw new Error("Original transaction not set");var t=function(e,t){var n=t.find((function(){return!0}));if(!n)throw new Error("First signature missing");return{transaction:e,primarySignature:n,otherSignatures:t.slice(1)}}(this.state.original.transaction,this.state.signatures);this.setState({posting:!0,postError:void 0}),function(e){return B.apply(this,arguments)}(t).then((function(t){console.log("Successfully posted",t),e.setState({posting:!1,postError:void 0,postSuccess:t})}),(function(t){console.info("Full error message",t);var n=t instanceof Error?t.message:t.toString();e.setState({posting:!1,postError:n})}))}}]),t}(a.a.Component);o.a.render(a.a.createElement(c.a,null,a.a.createElement(s.d,null,a.a.createElement(s.b,{exact:!0,path:"/create",component:oe}),a.a.createElement(s.b,{path:"/status",component:fe}),a.a.createElement(s.b,{path:"/sign",component:ce}),a.a.createElement(s.b,{path:"/",component:le}))),document.getElementById("root"))}},[[183,1,2]]]);
//# sourceMappingURL=main.45a0088b.chunk.js.map